<!-- type==2积分兑换 -->
<view wx:if="{{type==2}}">
    <view class="address" wx:if="{{isMaterial}}">
        <view class="select_address" wx:if="{{!address}}" bindtap="handleSelectAddress">
            <view class="address_title">
                <text class="iconfont icon-dizhi"></text>
                <text class="address_title">选择收货地址</text>
            </view>
            <view>
                <text class="iconfont icon-arrow-left"></text>
            </view>
        </view>
        <view class="address_info" wx:else bindtap="handleSelectAddress">
            <view class="icon">
                <text class="iconfont icon-dizhi"></text>
            </view>
            <view class="text">
                <view>
                    <text>收货人：{{address.contact}}</text>
                    <text>{{address.phone}}</text>
                </view>
                <view>
                    收货地址：{{address.province}}{{address.city}} {{address.district}}{{address.other}}
                </view>
            </view>
        </view>
    </view>

    <view class="goods">
        <view class="item" wx:for="{{goodsInfo}}" wx:key="id">
            <image src="{{item.thumbPicUrl}}"></image>
            <view>
                <view class="name">
                    {{item.name}}
                </view>
                <view class="description">
                    {{item.description}}
                </view>
                <view class="price">
                    <text>{{item.integrationQuantity}}积分</text>
                    <text>x {{item.quantity}}</text>
                </view>
            </view>
        </view>
    </view>

    <!-- <view> -->

    <view class="remark">
        <view class="label"><text>买家留言:</text></view>
        <view class="mark">
            <van-field border="{{false}}" input-class="field" value="{{ remark  }}" type="textarea" clearable placeholder="请输入留言" title-width="4em" bind:change="handleRemarkChange" maxlength="200" />
        </view>
    </view>
    <!-- <van-cell-group>
            <van-field value="{{ remark  }}" clearable label="买家留言" placeholder="请输入留言" title-width="4em" bind:change="handleRemarkChange" />
        </van-cell-group>
    </view> -->

    <view class="submit_order">
        <view>
            <text>合计：</text>
            <text>{{totalPrice}}积分</text>
        </view>
        <view bindtap="handlePay">
            提交订单
        </view>
    </view>
</view>

<!-- type==1 商城  -->
<view wx:else>
    <view class="address" wx:if="{{isMaterial}}">
        <view class="select_address" wx:if="{{!address}}" bindtap="handleSelectAddress">
            <view class="address_title">
                <text class="iconfont icon-dizhi"></text>
                <text class="address_title">选择收货地址</text>
            </view>
            <view>
                <text class="iconfont icon-arrow-left"></text>
            </view>
        </view>
        <view class="address_info" wx:else bindtap="handleSelectAddress">
            <view class="icon">
                <text class="iconfont icon-dizhi"></text>
            </view>
            <view class="text">
                <view>
                    <text>收货人：{{address.contact}}</text>
                    <text>{{address.phone}}</text>
                </view>
                <view>
                    收货地址：{{address.province}}{{address.city}} {{address.district}}{{address.other}}
                </view>
            </view>
        </view>
    </view>
    <view class="goods">
        <view class="item" wx:for="{{goodsInfo}}" wx:key="id">
            <image src="{{item.thumbPicUrl}}"></image>
            <view>
                <view class="name">
                    {{item.name}}
                </view>
                <view class="description">
                    {{item.description}}
                </view>
                <view class="price">
                    <text wx:if="{{item.isFaceCard || item.isSkinCare}}">{{item.salePrice}}元</text>
                    <text wx:else>{{item.selectStandardPrice}}元</text>
                    <text class="num">x {{item.quantity}}</text>
                </view>
            </view>
        </view>
    </view>

    <view class="remark">
        <view class="label"><text>买家留言:</text></view>
        <view class="mark">
            <van-field border="{{false}}" input-class="field" value="{{ remark  }}" type="textarea" clearable placeholder="请输入留言" title-width="4em" bind:change="handleRemarkChange" maxlength="200" />
        </view>
    </view>
    <view wx:if="{{voucherId!==''}}" class="voucher-list">
        <view class="voucher-title">使用的抵用券</view>
        <view class="voucher">
            <view class="voucher_left">
                <text>{{voucherType==4?we.toFixed(discount*10)+'折':deductMoney}}</text>
                <text>抵用券</text>
            </view>
            <view class="voucher_right">{{voucherName}}</view>
        </view>
    </view>
    <!-- 全局抵用券 -->
    <view wx:if="{{overAllVoucher}}" class="voucher-list">
        <view class="voucher-title">可使用的抵用券</view>
        <view data-index="{{index}}" data-deduct="{{item.deductMoney}}" bindtap="selectOverAllVoucher" data-id="{{item.id}}" wx:for="{{overAllVoucher}}" class="voucher_overall {{selectVoucherIndex==index ? 'active_voucher':''}}">
            <view class="voucher_left">
                <text>{{item.type==4?we.toFixed(item.deductMoney*10)+'折':item.deductMoney+'元'}}</text>
                <text>抵用券</text>
            </view>
            <view class="voucher_right">{{item.consumptionVoucherName}}</view>
        </view>
    </view>
    <!-- 支付方式 -->
    <view class="pay_list">
        <van-radio-group value="{{ pay }}" bind:change="onChange">
            <van-cell-group border="{{false}}">
                <!-- <van-cell border="{{false}}" inset="{{true}}" title="支付宝" clickable data-name="1" bind:click="onClick">
                    <van-radio slot="right-icon" name="1" />
                </van-cell> -->
                <van-cell border="{{false}}" inset="{{true}}" title="微信" clickable data-name="4" bind:click="onClick">
                    <van-radio slot="right-icon" name="4" />
                </van-cell>
                <!-- <van-cell border="{{false}}" inset="{{true}}" title="余额" clickable data-name="3" bind:click="onClick">
                    <van-radio slot="right-icon" name="3" />
                </van-cell> -->
            </van-cell-group>
        </van-radio-group>
    </view>
    <view class="submit_order">
        <view>
            <text>合计：</text>
            <text>{{(allmoney-deductMoney)<0?'0':(allmoney-deductMoney)}}元</text>
        </view>
        <view bindtap="handlePay" data-isMaterial="{{isMaterial}}" data-allmoney="{{allmoney}}">
            提交订单
        </view>
    </view>
</view>
<wxs module="we">
    var toFixed = function (value) {
        return value.toFixed(1);
    }
    module.exports = {
        toFixed: toFixed
    }
</wxs>